#!/usr/bin/env ruby

require 'yaml'
require 'relsr' 
config_file = 'relsr.yml'

unless File.exists?(config_file)
  puts 'Could not file relsr.yml file.'
  exit 1
end

begin
  config = YAML.load_file(config_file)
  raise 'repo: has not been set' if config['repo'].nil?
  raise 'label: has not been set' if config['label'].nil?
  repo = config['repo']
  label = config['label']
rescue StandardError => e
  puts 'invalid relsr.yml file'
  puts e.message
  exit 1
end

dry_run = true
manager = Relsr::ReleaseManager.new(repo, label, dry_run)
manager.create_release
manager.create_pull_request
